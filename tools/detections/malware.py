def detect(logs, page=1, page_size=50):
    # Known malicious process signatures
    malware_signatures = [
        "mimikatz",
        "powershell -enc",
        "nc.exe",
        "keylogger",
        "meterpreter"
    ]

    findings = []

    for log in logs:
        process = log.get("process", "").lower()
        path = log.get("path", "").lower()

        confidence = 0.0
        matched = False

        # Signature match
        for sig in malware_signatures:
            if sig in process:
                matched = True
                confidence += 0.6

        # Suspicious path
        if "temp" in path or "appdata" in path:
            confidence += 0.2

        if matched:
            findings.append({
                "type": "malware",
                "host": log.get("host"),
                "process": log.get("process"),
                "path": log.get("path"),
                "severity": "critical" if confidence >= 0.8 else "high",
                "confidence": round(min(confidence, 1.0), 2)
            })

    total = len(findings)

    # Pagination
    start = (page - 1) * page_size
    end = start + page_size
    paginated = findings[start:end]

    return {
        "total": total,
        "page": page,
        "page_size": page_size,
        "findings": paginated
    }
