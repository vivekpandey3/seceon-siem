from tools.detections.malware import detect

def test_malware_detected():
    logs = [
        {
            "timestamp": "2026-01-12T11:00:00",
            "host": "PC-1",
            "process": "mimikatz.exe",
            "path": "C:\\temp\\mimikatz.exe"
        }
    ]

    result = detect(logs)

    assert result["total"] == 1
    assert result["findings"][0]["type"] == "malware"
    assert result["findings"][0]["host"] == "PC-1"
    assert "mimikatz" in result["findings"][0]["process"]
